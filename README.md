# Blueternet - Beta
Experience Internet using Bluetooth

블루투스를 이용한 웹 서핑~

### ETC
kotlin Coroutine, MVVM Pattern, Okhttp 등 사용. 테스트는 무료 api를 제공해주는 manana.kr 사용.

![KakaoTalk_20240816_173258470](https://github.com/user-attachments/assets/956b8742-7c20-44a5-af6e-5e971e46322d)

### 이게 무엇인가요?
간단하게 설명하자면 블루투스 테더링과 동일한 기능을 하는 어플이라 볼 수 있겠습니다.

클라이언트 기능을 하는 어플 하나와, 서버 역할을 하는 어플 두개로 구성되어 있으며, 클라이언트가 서버와 블루투스로 연결되어 있다면, 클라이언트는 네트워크 연결 필요 없이 서버를 통해 웹 요청을 보내고 받을 수 있습니다.

### 좀더 자세히..
Postman을 블루투스를 이용해 수행한다고 보시면 되겠습니다. 클라이언트는 위 스크린샷처럼 url, content type, body를 명시하고, 연결된 블루투스 기기 (서버)로 웹 요청 데이터를 전달하면, 해당 서버는 해당 json 요청을 받아 url로 요청을 넣은뒤 결과값을 다시 블루투스를 이용해 전달합니다. 위 스크린샷도 현재 wifi, 셀룰러와 같이 외부 네트워크가 연결되어 있지 않음에도, 블루투스를 통해 api 요청을 수행한 모습을 확인할 수 있습니다.

좀더 향상될 수 있다면, html을 결과값으로 받는 content-type인 x-www-form-urlencoded를 활용해 웹 html을 읽어와 화면에 띄워주는 방식도 이뤄낼 수 있을것으로 보여지나.. 테스트 해본결과(네이버) html과 동봉된 js구문이 너무 길어 문제가 발생했습니다. 이 부분은 js부분을 제거해서 파싱하는 방식으로 가능할것 같습니다.

### 지금은 어디까지 되나요?
url을 이용한 GET 요청은 가능하며, body를 입력받는 post요청은 아직 추가되지 않았습니다. 만약 추가한다면 GET / POST / PUT / DELETE등의 선택지를 부여, Request class에 타입 enum을 넣어서 잘 핸들링하면 되지 않을까 싶습니다.

### 앱의 구조는?
#### 위에서 설명드렸다 시피 클라이언트 앱과 서버 앱으로 구성되어 있습니다.

#### 1) 클라이언트
기본적으로 MVVM 패턴을 기준으로 하여, Bluetooth에 접근하는 Dao인 Bluetooth Service를 기반으로 레포지토리를 작성하고 뷰모델에서 사용하는 방식으로 구성하였습니다. 원래는 유스케이스로 분리해서 결합도를 낮춰야 하나, 현재 토이프로젝트라 간결하게 하다보니 생략하게 되었습니다.

또한, Repository는 블루투스 연결 정보를 갖고 직접 핸들링 하는 Stateful 방식을 갖고 있습니다. 따라서 레포지토리가 상태를 가지고 있어 VM에서는 레포지토리를 이용해 블루투스 정보를 제어할 수 있습니다.

https://velog.io/@choi-hyeseong/Android-Stateful-Repository

위 작성했던 글 처럼 블루투스 연결시 정보가 전달되는 부분을 VM에서 콜백과 메소드로 접근할 수 있게 하여 최대한 결합도를 줄이고 유연하게 처리할 수 있도록 하였습니다.

#### 2) 서버
서버도 동일하게 MVVM 패턴을 기준으로 작성하였고, 위 클라이언트와 공유되는 코드가 많습니다. (멀티모듈로 전환할 수 있으면 좋을것 같음)
서버는 실행시 onCreate에서 블루투스 작동여부를 확인하고, 서버를 동작시킵니다.

#### 3) 과정
서버가 동작중일때 클라이언트가 UUID를 이용해 서버와 연결이 이루어졌을경우, 클라이언트는 웹 요청을 서버에게 전달할 수 있습니다. 현재 구조는 url, content-type, body로 이루어진 data class를 json으로 직렬화 한뒤, 서버에서 역직렬화 하는 과정을 거칩니다. 이후, 해당 요청을 가지고 okhttp를 이용해 웹 요청을 한 뒤, 역순으로 클라이언트에게 전달됩니다.

### 시연 영상
![GIFMaker_me](https://github.com/user-attachments/assets/bfb80cf8-190e-46ea-8e8a-a2e47b1df212)
